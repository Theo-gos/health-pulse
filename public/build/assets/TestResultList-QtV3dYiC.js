import{y as re,r as le,j as b}from"./app-B-st9BtI.js";import"./lodash-CvmcnPJT.js";import{u as Pe,D as _e,a as we,M as xe}from"./index-BrEBPJ0Z.js";import{u as Ee}from"./chunk-7JBTTEVG-Jxzi3SVC.js";import{a as Ce,b as Se,c as Re}from"./chunk-4FCEGNGT-Z6ZvjLQp.js";import{F as ce,B as te}from"./chunk-KRPLQIP4-BlAVN8HP.js";var se={exports:{}},de={};(function(C){var i=re;function q(t){var r=Object.create(null);return t&&Object.keys(t).forEach(function(c){if(c!=="default"){var n=Object.getOwnPropertyDescriptor(t,c);Object.defineProperty(r,c,n.get?n:{enumerable:!0,get:function(){return t[c]}})}}),r.default=t,Object.freeze(r)}var j,e=q(le);C.ThumbnailDirection=void 0,(j=C.ThumbnailDirection||(C.ThumbnailDirection={})).Horizontal="Horizontal",j.Vertical="Vertical";var Q=function(){return Q=Object.assign||function(t){for(var r,c=1,n=arguments.length;c<n;c++)for(var d in r=arguments[c])Object.prototype.hasOwnProperty.call(r,d)&&(t[d]=r[d]);return t},Q.apply(this,arguments)},ae=function(t){var r=t.doc,c=t.getPageIndex,n=t.renderSpinner,d=t.store,o=t.width,w=r.numPages,p=c?c({numPages:w}):0,m=Math.max(0,Math.min(p,w-1)),f=d.get("pagesRotation")||new Map,W=f.has(m)?f.get(m):0,R=e.useState(""),I=R[0],s=R[1],N=i.useIsMounted(),M=e.useRef(),g=e.useState(d.get("rotation")||0),x=g[0],v=g[1],P=e.useState(W),V=P[0],h=P[1],D=e.useState(!1),B=D[0],k=D[1],O=function(_){var L=_.has(m)?_.get(m):0;h(L)},$=function(_){v(_)},K=i.useIntersectionObserver({onVisibilityChanged:function(_){k(_.isVisible)}});return e.useEffect(function(){if(B){var _=K.current;_&&(s(""),i.getPage(r,m).then(function(L){var E=L.getViewport({scale:1}),z=(E.rotation+x+V)%360,Y=Math.abs(x+V)%180==0,F=Y?E.width:E.height,G=Y?E.height:E.width,H=document.createElement("canvas"),Z=H.getContext("2d",{alpha:!1}),ee=_.clientWidth,X=_.clientHeight,u=o?o/F:Math.min(ee/F,X/G),a=u*F,S=u*G;H.height=S,H.width=a,H.style.opacity="0";var A=L.getViewport({rotation:z,scale:u});M.current=L.render({canvasContext:Z,viewport:A}),M.current.promise.then(function(){N.current&&s(H.toDataURL()),H.width=0,H.height=0},function(){})}))}},[V,B]),e.useEffect(function(){return d.subscribe("pagesRotation",O),d.subscribe("rotation",$),function(){d.unsubscribe("pagesRotation",O),d.unsubscribe("rotation",$)}},[]),e.useEffect(function(){return function(){var _;(_=M.current)===null||_===void 0||_.cancel()}},[]),e.createElement("div",{ref:K,className:"rpv-thumbnail__cover-inner","data-testid":"thumbnail__cover-inner"},I?e.createElement("img",{className:"rpv-thumbnail__cover-image","data-testid":"thumbnail__cover-image",src:I}):e.createElement("div",{className:"rpv-thumbnail__cover-loader","data-testid":"thumbnail__cover-loader"},n?n():e.createElement(i.Spinner,null)))},ie=function(t){var r=t.getPageIndex,c=t.renderSpinner,n=t.store,d=t.width,o=e.useState(n.get("doc")),w=o[0],p=o[1],m=function(f){p(f)};return e.useEffect(function(){return n.subscribe("doc",m),function(){n.unsubscribe("doc",m)}},[]),e.createElement("div",{className:"rpv-thumbnail__cover"},w?e.createElement(ae,{doc:w,getPageIndex:r,renderSpinner:c,store:n,width:d}):e.createElement("div",{className:"rpv-thumbnail__cover-loader"},c?c():e.createElement(i.Spinner,null)))},ne=function(){return e.createElement(i.Spinner,null)},y=e.createContext({renderSpinner:ne}),ge=function(t){var r=t.children,c=t.doc,n=i.useIsMounted(),d=e.useState({loading:!0,labels:[]}),o=d[0],w=d[1];return e.useEffect(function(){c.getPageLabels().then(function(p){n.current&&w({loading:!1,labels:p||[]})})},[c.loadingTask.docId]),o.loading?e.createElement(e.Fragment,null):r(o.labels)},he=function(t){var r=t.page,c=t.pageHeight,n=t.pageIndex,d=t.pageWidth,o=t.rotation,w=t.thumbnailHeight,p=t.thumbnailWidth,m=t.onRenderCompleted,f=e.useContext(i.LocalizationContext).l10n,W=e.useRef(),R=e.useState(""),I=R[0],s=R[1],N=f&&f.thumbnail?f.thumbnail.thumbnailLabel:"Thumbnail of page {{pageIndex}}";return e.useEffect(function(){var M=W.current;M&&M.cancel();var g=document.createElement("canvas"),x=g.getContext("2d",{alpha:!1}),v=p,P=v/(d/c),V=v/d;g.height=P,g.width=v,g.style.height="".concat(P,"px"),g.style.width="".concat(v,"px");var h=r.getViewport({rotation:o,scale:V});return W.current=r.render({canvasContext:x,viewport:h}),W.current.promise.then(function(){s(g.toDataURL()),m(n)},function(){m(n)}),function(){var D;(D=W.current)===null||D===void 0||D.cancel()}},[o]),I?e.createElement("img",{"aria-label":N.replace("{{pageIndex}}","".concat(n+1)),src:I,height:"".concat(w,"px"),width:"".concat(p,"px")}):e.useContext(y).renderSpinner()},me=function(t){var r=t.doc,c=t.pageHeight,n=t.pageIndex,d=t.pageRotation,o=t.pageWidth,w=t.rotation,p=t.shouldRender,m=t.thumbnailWidth,f=t.onRenderCompleted,W=t.onVisibilityChanged,R=i.useIsMounted(),I=e.useState({height:c,page:null,viewportRotation:0,width:o}),s=I[0],N=I[1],M=s.page,g=s.height,x=s.width,v=x/g,P=Math.abs(w+d)%180==0,V=P?m:m/v,h=P?m/v:m;e.useEffect(function(){p&&i.getPage(r,n).then(function(k){var O=k.getViewport({scale:1});R.current&&N({height:O.height,page:k,viewportRotation:O.rotation,width:O.width})})},[p]);var D=(s.viewportRotation+w+d)%360,B=i.useIntersectionObserver({onVisibilityChanged:function(k){W(n,k)}});return e.createElement("div",{className:"rpv-thumbnail__container","data-testid":"thumbnail__container-".concat(n),ref:B,style:{height:"".concat(h,"px"),width:"".concat(V,"px")}},M?e.createElement(he,{page:M,pageHeight:P?g:x,pageIndex:n,pageWidth:P?x:g,rotation:D,thumbnailHeight:h,thumbnailWidth:V,onRenderCompleted:f}):e.useContext(y).renderSpinner())},be=function(t){var r=t.currentPage,c=t.doc,n=t.labels,d=t.pagesRotation,o=t.pageHeight,w=t.pageWidth,p=t.renderCurrentPageLabel,m=t.renderThumbnailItem,f=t.rotatedPage,W=t.rotation,R=t.thumbnailDirection,I=t.thumbnailWidth,s=t.viewMode,N=t.onJumpToPage,M=t.onRotatePage,g=c.numPages,x=c.loadingTask.docId,v=e.useRef(null),P=e.useRef([]),V=e.useState(r),h=V[0],D=V[1],B=e.useContext(i.ThemeContext).direction===i.TextDirection.RightToLeft,k=e.useState(-1),O=k[0],$=k[1],K=i.useIsMounted(),_=i.usePrevious(s),L=e.useRef(!1),E=i.useRenderQueue({doc:c}),z=e.useMemo(function(){return Array(g).fill(0).map(function(u,a){return a})},[x]),Y=e.useMemo(function(){switch(s){case i.ViewMode.DualPage:return i.chunk(z,2);case i.ViewMode.DualPageWithCover:return[[z[0]]].concat(i.chunk(z.slice(1),2));case i.ViewMode.SinglePage:default:return i.chunk(z,1)}},[x,s]),F=function(){if(v.current){var u=P.current,a=h+1;a<u.length&&(h>=0&&u[h].setAttribute("tabindex","-1"),D(a))}},G=function(){if(v.current){var u=P.current,a=h-1;a>=0&&(h>=0&&u[h].setAttribute("tabindex","-1"),D(a))}},H=function(){h>=0&&h<g&&N(h)};i.useIsomorphicLayoutEffect(function(){var u=v.current;u&&(P.current=Array.from(u.querySelectorAll(".rpv-thumbnail__item")))},[s]),e.useEffect(function(){var u=P.current;if(!(u.length===0||h<0||h>u.length)){var a=u[h];a.setAttribute("tabindex","0"),a.focus()}},[h]),i.useIsomorphicLayoutEffect(function(){var u=v.current,a=P.current;if(!(!u||a.length===0||r<0||r>a.length)){var S=a[r].closest(".rpv-thumbnail__items");S&&(R===C.ThumbnailDirection.Vertical?function(A,l){var T=A.getBoundingClientRect().top-l.getBoundingClientRect().top,U=A.clientHeight,J=l.clientHeight;T<0?l.scrollTop+=T:T+U<=J||(l.scrollTop+=T+U-J)}(S,u):function(A,l){var T=A.getBoundingClientRect().left-l.getBoundingClientRect().left,U=A.clientWidth,J=l.clientWidth;T<0?l.scrollLeft+=T:T+U<=J||(l.scrollLeft+=T+U-J)}(S,u))}},[r,R]);var Z=e.useCallback(function(u){K.current&&(E.markRendered(u),L.current=!1,X())},[x]),ee=e.useCallback(function(u,a){a.isVisible?E.setVisibility(u,a.ratio):E.setOutOfRange(u),X()},[x]),X=e.useCallback(function(){if(!L.current){var u=E.getHighestPriorityPage();u>-1&&(E.markRendering(u),L.current=!0,$(u))}},[x]);return e.useEffect(function(){f>=0&&(E.markRendering(f),L.current=!0,$(f))},[x,f]),i.useIsomorphicLayoutEffect(function(){_!==s&&(E.markNotRendered(),X())},[s]),e.createElement("div",{ref:v,"data-testid":"thumbnail__list",className:i.classNames({"rpv-thumbnail__list":!0,"rpv-thumbnail__list--horizontal":R===C.ThumbnailDirection.Horizontal,"rpv-thumbnail__list--rtl":B,"rpv-thumbnail__list--vertical":R===C.ThumbnailDirection.Vertical}),onKeyDown:function(u){switch(u.key){case"ArrowDown":F();break;case"ArrowUp":G();break;case"Enter":H()}}},Y.map(function(u,a){var S=!1;switch(s){case i.ViewMode.DualPage:S=r===2*a||r===2*a+1;break;case i.ViewMode.DualPageWithCover:S=r===0&&a===0||a>0&&r===2*a-1||a>0&&r===2*a;break;case i.ViewMode.SinglePage:default:S=r===a}return e.createElement("div",{className:i.classNames({"rpv-thumbnail__items":!0,"rpv-thumbnail__items--dual":s===i.ViewMode.DualPage,"rpv-thumbnail__items--dual-cover":s===i.ViewMode.DualPageWithCover,"rpv-thumbnail__items--single":s===i.ViewMode.SinglePage,"rpv-thumbnail__items--selected":S}),key:"".concat(a,"___").concat(s)},u.map(function(A){return function(l){var T=s===i.ViewMode.DualPageWithCover&&(l===0||g%2==0&&l===g-1),U="".concat(c.loadingTask.docId,"___").concat(l),J=n.length===g?n[l]:"".concat(l+1),oe=p?p({currentPage:r,pageIndex:l,numPages:g,pageLabel:J}):J,fe=d.has(l)?d.get(l):0,ue=e.createElement(me,{doc:c,pageHeight:o,pageIndex:l,pageRotation:fe,pageWidth:w,rotation:W,shouldRender:O===l,thumbnailWidth:I,onRenderCompleted:Z,onVisibilityChanged:ee});return m?m({currentPage:r,key:U,numPages:g,pageIndex:l,renderPageLabel:e.createElement(e.Fragment,null,oe),renderPageThumbnail:ue,onJumpToPage:function(){return N(l)},onRotatePage:function(ve){return M(l,ve)}}):e.createElement("div",{key:U},e.createElement("div",{className:i.classNames({"rpv-thumbnail__item":!0,"rpv-thumbnail__item--dual-even":s===i.ViewMode.DualPage&&l%2==0,"rpv-thumbnail__item--dual-odd":s===i.ViewMode.DualPage&&l%2==1,"rpv-thumbnail__item--dual-cover":T,"rpv-thumbnail__item--dual-cover-even":s===i.ViewMode.DualPageWithCover&&!T&&l%2==0,"rpv-thumbnail__item--dual-cover-odd":s===i.ViewMode.DualPageWithCover&&!T&&l%2==1,"rpv-thumbnail__item--single":s===i.ViewMode.SinglePage,"rpv-thumbnail__item--selected":r===l}),role:"button",tabIndex:r===l?0:-1,onClick:function(){return N(l)}},ue),e.createElement("div",{"data-testid":"thumbnail__label-".concat(l),className:"rpv-thumbnail__label"},oe))}(A)}))}))},pe=function(t){var r=t.renderCurrentPageLabel,c=t.renderThumbnailItem,n=t.store,d=t.thumbnailDirection,o=t.thumbnailWidth,w=e.useState(n.get("doc")),p=w[0],m=w[1],f=e.useState(n.get("currentPage")||0),W=f[0],R=f[1],I=e.useState(n.get("pageHeight")||0),s=I[0],N=I[1],M=e.useState(n.get("pageWidth")||0),g=M[0],x=M[1],v=e.useState(n.get("rotation")||0),P=v[0],V=v[1],h=e.useState(n.get("pagesRotation")||new Map),D=h[0],B=h[1],k=e.useState(n.get("rotatedPage")||-1),O=k[0],$=k[1],K=e.useState(n.get("viewMode")),_=K[0],L=K[1],E=function(a){R(a)},z=function(a){m(a)},Y=function(a){N(a)},F=function(a){x(a)},G=function(a){V(a)},H=function(a){B(a)},Z=function(a){$(a)},ee=function(a){L(a)},X=function(a){var S=n.get("jumpToPage");S&&S(a)},u=function(a,S){n.get("rotatePage")(a,S)};return e.useEffect(function(){return n.subscribe("doc",z),n.subscribe("pageHeight",Y),n.subscribe("pageWidth",F),n.subscribe("rotatedPage",Z),n.subscribe("rotation",G),n.subscribe("pagesRotation",H),n.subscribe("viewMode",ee),function(){n.unsubscribe("doc",z),n.unsubscribe("pageHeight",Y),n.unsubscribe("pageWidth",F),n.unsubscribe("rotatedPage",Z),n.unsubscribe("rotation",G),n.unsubscribe("pagesRotation",H),n.unsubscribe("viewMode",ee)}},[]),i.useIsomorphicLayoutEffect(function(){return n.subscribe("currentPage",E),function(){n.unsubscribe("currentPage",E)}},[]),p?e.createElement(i.LazyRender,{testId:"thumbnail__list-container",attrs:{className:"rpv-thumbnail__list-container"}},e.createElement(ge,{doc:p},function(a){return e.createElement(be,{currentPage:W,doc:p,labels:a,pagesRotation:D,pageHeight:s,pageWidth:g,renderCurrentPageLabel:r,renderThumbnailItem:c,rotatedPage:O,rotation:P,thumbnailDirection:d,thumbnailWidth:o,viewMode:_,onJumpToPage:X,onRotatePage:u})})):e.createElement("div",{"data-testid":"thumbnail-list__loader",className:"rpv-thumbnail__loader"},e.useContext(y).renderSpinner())};C.thumbnailPlugin=function(t){var r=e.useMemo(function(){return i.createStore({rotatePage:function(){},viewMode:i.ViewMode.SinglePage})},[]),c=e.useState(""),n=c[0],d=c[1];return{install:function(o){r.update("jumpToPage",o.jumpToPage),r.update("rotatePage",o.rotatePage)},onDocumentLoad:function(o){d(o.doc.loadingTask.docId),r.update("doc",o.doc)},onViewerStateChange:function(o){return r.update("currentPage",o.pageIndex),r.update("pagesRotation",o.pagesRotation),r.update("pageHeight",o.pageHeight),r.update("pageWidth",o.pageWidth),r.update("rotation",o.rotation),r.update("rotatedPage",o.rotatedPage),r.update("viewMode",o.viewMode),o},Cover:function(o){return e.createElement(ie,Q({},o,{renderSpinner:t==null?void 0:t.renderSpinner,store:r}))},Thumbnails:e.useCallback(function(o){return e.createElement(y.Provider,{value:{renderSpinner:(t==null?void 0:t.renderSpinner)||ne}},e.createElement(pe,{renderCurrentPageLabel:t==null?void 0:t.renderCurrentPageLabel,renderThumbnailItem:o==null?void 0:o.renderThumbnailItem,store:r,thumbnailDirection:(o==null?void 0:o.thumbnailDirection)||C.ThumbnailDirection.Vertical,thumbnailWidth:(t==null?void 0:t.thumbnailWidth)||100}))},[n])}}})(de);/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */se.exports=de;var Me=se.exports;function ye(C){const{PageThumbnail:i}=C;return{renderViewer:q=>{let{slot:j}=q;return j.children=i,j.subSlot.attrs={},j.subSlot.children=b.jsx(b.Fragment,{}),j}}}function Ie({fileUrl:C,width:i,pageIndex:q}){const j=Me.thumbnailPlugin(),{Cover:e}=j,Q=ye({PageThumbnail:b.jsx(e,{width:i,getPageIndex:()=>q})});return b.jsx(re.Viewer,{fileUrl:C,plugins:[Q,j]})}function Le({data:C,width:i="50%"}){const[q,j]=le.useState(""),{isOpen:e,onOpen:Q,onClose:ae}=Ee(),ie=Pe({query:"(max-width: 844px)"}),ne=y=>{j(y),Q()};return C.tests.length>0?C.tests.map(y=>b.jsxs(ce,{w:i,borderRadius:"xl",bg:"#F2F7FF",align:"center",fontSize:"11px",_hover:{backgroundColor:"#BEE3F8",cursor:"pointer"},onClick:()=>ne(y.detail.result_url),children:[b.jsx(te,{w:"fit-content",children:b.jsx(Ie,{fileUrl:y.detail.result_url,width:40,pageIndex:0})}),b.jsxs(ce,{w:"90%",px:"18px",align:"center",justify:"space-between",children:[b.jsx(te,{fontWeight:"bold",fontSize:"13px",children:y.detail.name}),b.jsx(te,{fontSize:"12px",color:"gray",children:y.detail.date})]}),b.jsxs(_e,{onClose:ae,isOpen:e&&!ie,size:"xl",children:[b.jsx(Ce,{}),b.jsxs(we,{children:[b.jsx(Se,{}),b.jsx(xe,{children:`Pdf Viewer - ${y.detail.name}`}),b.jsx(Re,{children:b.jsx(te,{w:"100%",overflowY:"scroll",children:b.jsx(re.Viewer,{fileUrl:q})})})]})]})]},y.detail.id)):b.jsx(te,{children:"No available test results"})}export{Le as t};
