import{q as H,r as u,W as B,j as e,e as N}from"./app-B-st9BtI.js";import{d as F}from"./dayjs.min-BznShDkh.js";import{B as t,F as h,C as K}from"./chunk-KRPLQIP4-BlAVN8HP.js";import{I as U}from"./chunk-6CVSDS6C-BmeBEkKM.js";import{H as X}from"./chunk-3ASUQ6PA-BuiPcMK8.js";import{S as D}from"./chunk-ZHMYA64R-DtvKkc4C.js";import{_ as z}from"./lodash-CvmcnPJT.js";import{t as J}from"./TestResultList-QtV3dYiC.js";import{S as $}from"./chunk-NEK3OOAM-Dgi7vmsA.js";import{C as Q}from"./chunk-Q6Q7I7E5-B8Zb2bBP.js";import{D as Z}from"./DoctorLayout-Dyh4Qz7G.js";import"./index-BrEBPJ0Z.js";import"./chunk-4FCEGNGT-Z6ZvjLQp.js";import"./defineProperty-DmAPQKcv.js";import"./iconBase-ChLQLo6q.js";import"./chunk-7JBTTEVG-Jxzi3SVC.js";import"./chunk-JARCRF6W-Cq7xPRAG.js";import"./Logo-xk-lhgy1.js";const Y=F().second(0).millisecond(0),m={AGE:"age",NAME:"name"},ee=(o,i)=>F(o).hour(i.split(":")[0]).minute(i.split(":")[1]).second(0).millisecond(0),te=(o,i)=>{const n={};let c=Number.MAX_SAFE_INTEGER;if(n.patientId=o.patient.id,n.name=o.patient.name,n.age=o.patient.age,o.appointments){const r=o.appointments.reduce((d,b)=>{const x=F(b.detail.date).second(0).millisecond(0),w=Math.abs(x.diff(Y));return w<c&&b.doctor.id===i.id&&(c=w,d=b),d},{});n.date=r.detail.date;const A=`${r.detail.start_time.split(":")[0]}:${r.detail.start_time.split(":")[1]}`,p=`${r.detail.end_time.split(":")[0]}:${r.detail.end_time.split(":")[1]}`;n.startTime=A,n.endTime=p}return n},oe=o=>e.jsxs(e.Fragment,{children:[e.jsx(t,{style:o.links[0].url?{color:"#1366DE",cursor:"pointer"}:{color:"gray",cursor:"not-allowed"},children:o.links[0].url?e.jsx(N,{href:o.first_page_url,children:"<<"}):"<<"}),e.jsx(t,{style:o.links[0].url?{color:"#1366DE",cursor:"pointer"}:{color:"gray",cursor:"not-allowed"},children:o.links[0].url?e.jsx(N,{href:o.links[0].url,children:"<"}):"<"}),o.links.filter(i=>i.url&&Number(i.label)).map(i=>e.jsx(N,{href:i.url,children:e.jsx(K,{style:i.active?{opacity:.4}:{cursor:"pointer"},_hover:i.active?{}:{backgroundColor:"blue.100",color:"white"},size:"27px",bg:i.active?"blue.100":"transparent",color:i.active?"gray":"#1366DE",children:e.jsx(t,{children:i.label})})},i.label)),e.jsx(t,{style:o.links[o.links.length-1].url?{color:"#1366DE",cursor:"pointer"}:{color:"gray",cursor:"not-allowed"},children:o.links[o.links.length-1].url?e.jsx(N,{href:o.links[o.links.length-1].url,children:">"}):">"}),e.jsx(t,{style:o.links[o.links.length-1].url?{color:"#1366DE",cursor:"pointer"}:{color:"gray",cursor:"not-allowed"},children:o.links[o.links.length-1].url?e.jsx(N,{href:o.last_page_url,children:">>"}):">"})]});function M({selectManager:o,medicalInfo:i,paginator:n}){const c=new URLSearchParams(window.location.search),{selected:r,setSelected:A}=o,{auth:p}=H().props;u.useState("");const[d,b]=u.useState(0),[x,w]=u.useState(c.get("age")?m.AGE:m.NAME),{get:C,data:a,setData:T,reset:g}=B({name:c.get("name")||"",age:c.get("age")||"",page:n.current_page}),v=Object.values(i);console.log(n);const k=E=>{a[x]=E,C(route("doctor.records"))};return e.jsxs(t,{w:"100%",h:"100%",p:"16px",borderRadius:"xl",bg:"#F6F7FA",children:[e.jsx(t,{fontSize:"20px",fontWeight:"bold",borderBottom:"1px solid black",mb:"24px",children:"Patients List"}),e.jsxs(h,{w:"100%",mb:"16px",align:"center",children:[e.jsxs(h,{w:"20%",align:"center",borderRadius:"20px",border:"1px solid #ECEDED",mr:"4px",children:[e.jsx(t,{w:"50%",h:"100%",py:"10px",borderLeftRadius:"20px",_hover:x==m.AGE?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:x==m.NAME?"blue.100":"white",color:x==m.NAME?"#1366DE":"gray",fontWeight:x==m.NAME?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>{T({...a,name:"",age:""}),w(m.NAME),d&&(clearTimeout(d),b(0))},children:"Name"}),e.jsx(t,{w:"50%",h:"100%",py:"10px",borderRightRadius:"20px",_hover:x==m.NAME?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:x==m.AGE?"blue.100":"white",color:x==m.AGE?"#1366DE":"gray",fontWeight:x==m.AGE?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>{T({...a,name:"",age:""}),w(m.AGE),d&&(clearTimeout(d),b(0))},children:"Age"})]}),e.jsx(U,{placeholder:`Type a patient ${x}...`,value:a[x],onChange:E=>{T(x,E.target.value),d&&clearTimeout(d),b(setTimeout(()=>{k(E.target.value)},1e3))},size:"md",borderRadius:"xl",bg:"white"})]}),e.jsx(X,{justify:"center",mb:"16px",color:"#1366DE",spacing:5,children:n.total>n.per_page?oe(n):""}),e.jsx(t,{w:"100%",h:"90%",overflowY:"scroll",children:e.jsx(D,{spacing:3,children:v.length>0?v.map(E=>{const R=te(E,p.doctor);if(R){const{patientId:y,name:s,age:l,date:W,startTime:O,endTime:q}=R,V=ee(W,O);return e.jsxs(t,{w:"100%",p:"16px",borderRadius:"xl",border:"1px solid gray",_hover:{cursor:"pointer",backgroundColor:"#EAF1FA",color:"#1366DE"},bg:r===y?"#EAF1FA":"transparent",color:r===y?"#1366DE":"black",onClick:()=>A(y),fontSize:"14px",children:[e.jsx(t,{fontWeight:"bold",children:`${s}, ${l} years old`}),V.diff(Y)<0?e.jsx(t,{fontSize:"12px",fontWeight:"bold",mt:"4px",children:"Last visit:"}):e.jsx(t,{fontSize:"12px",fontWeight:"bold",mt:"4px",children:"Next Visit:"}),e.jsxs(t,{fontSize:"12px",children:["Date: ",W]}),e.jsxs(t,{fontSize:"12px",children:["Time: ",`${O} - ${q}`]})]},y)}else return e.jsx(e.Fragment,{})}):e.jsx(t,{fontWeight:"bold",ml:"8px",children:"No booked patients"})})})]})}const re=F().second(0).millisecond(0),_={Stable:"black",Fair:"#AF8CFA",Mild:"#FFC999",Severe:"#DE5031"},j={DATE:"date",DOCTOR:"doctor_name"},S={GENERAL:"general",PRESCRIPTION:"prescription"},f={APPOINTMENTS:"appointments",TESTS:"tests"};function se(o){return!isNaN(Date.parse(o))}const P=o=>{const i=o.split("-");return`${i[2]}.${i[1]}.${i[0]}`},ie=o=>o.filter(n=>{const c=n.detail.start_time.split(":"),r=F(n.detail.date).hour(Number(c[0])).minute(Number(c[1])).second(0).millisecond(0);return re.diff(r)>0}),I=(o,i="date")=>{const n={};return o.forEach(c=>{const r=c.detail;r.doctor_name=c.doctor.name,n[r[i]]?n[r[i]].push(r):n[r[i]]=[r]}),n};function ne({selectManager:o,medicalInfo:i,icd:n,medications:c}){const[r,A]=u.useState({}),[p,d]=u.useState(S.GENERAL),[b,x]=u.useState({}),[w,C]=u.useState([]),[a,T]=u.useState(f.APPOINTMENTS),[g,v]=u.useState(j.DATE),{get:k}=B(),{selected:E}=o,R=Object.keys(b);u.useEffect(()=>{A(i[E])},[E]),u.useEffect(()=>{z.isEmpty(r)||(C(ie(r.appointments)),x(I(r.prescriptions,g)))},[r]),u.useMemo(()=>{z.isEmpty(r)||x(I(r.prescriptions,g))},[g]);const y=s=>{k(route("appointment.note",{appointment:s}))};return z.isEmpty(r)?e.jsx(Q,{mx:"auto",mt:"45vh",isIndeterminate:!0,color:"blue.300"}):e.jsxs(t,{w:"100%",h:"100%",p:"16px",borderRadius:"xl",bg:"#F6F7FA",children:[e.jsxs(t,{mb:"24px",children:[e.jsx(t,{fontSize:"36px",fontWeight:"bold",children:"Medical Record"}),e.jsxs(h,{align:"center",justify:"flex-start",textAlign:"center",fontSize:"14px",mt:"16px",children:[e.jsx(t,{p:"2px 6px",_hover:p!=S.GENERAL?{color:"#1366DE",cursor:"pointer"}:{},borderBottom:p==S.GENERAL?"1px solid #1366DE":"1px solid gray",color:p==S.GENERAL?"#1366DE":"gray",onClick:()=>{p!=S.GENERAL&&d(S.GENERAL)},children:"General"}),e.jsx(t,{p:"2px 6px",_hover:p!="prescription"?{color:"#1366DE",cursor:"pointer"}:{},borderBottom:p=="prescription"?"1px solid #1366DE":"1px solid gray",color:p=="prescription"?"#1366DE":"gray",onClick:()=>{p!="prescription"&&d("prescription")},children:"Prescriptions"})]})]}),p==S.GENERAL?e.jsx(t,{w:"100%",h:"82%",overflowY:"scroll",children:e.jsxs(D,{spacing:6,children:[e.jsxs(t,{w:"100%",children:[e.jsx(t,{fontWeight:"bold",ml:"6px",children:"Allergies"}),e.jsxs($,{mt:"16px",columns:3,spacing:"16px",children:[e.jsxs(t,{h:"10vh",p:"12px",fontSize:"12px",bg:"white",border:"1px solid #EEEFF1",borderRadius:"xl",children:[e.jsx(t,{color:"gray.500",children:"Drug"}),e.jsx(D,{w:"100%",spacing:1,mt:"2px",overflowY:"scroll",children:r.allergies?r.allergies.Drug?r.allergies.Drug.map((s,l)=>e.jsxs(h,{w:"100%",justify:"space-between",align:"center",children:[e.jsx(t,{color:_[s.severity],fontWeight:"bold",children:s.severity}),e.jsx(t,{children:s.name})]},`drug-${l}`)):e.jsx(t,{fontWeight:"bold",children:"No known allergies"}):e.jsx(t,{fontWeight:"bold",children:"No known allergies"})})]}),e.jsxs(t,{h:"10vh",p:"12px",fontSize:"12px",bg:"white",border:"1px solid #EEEFF1",borderRadius:"xl",children:[e.jsx(t,{color:"gray.500",children:"Food"}),e.jsx(D,{w:"100%",spacing:1,mt:"2px",overflowY:"scroll",children:r.allergies?r.allergies.Food?r.allergies.Food.map((s,l)=>e.jsxs(h,{w:"100%",justify:"space-between",align:"center",children:[e.jsx(t,{color:_[s.severity],fontWeight:"bold",children:s.severity}),e.jsx(t,{children:s.name})]},`food-${l}`)):e.jsx(t,{fontWeight:"bold",children:"No known allergies"}):e.jsx(t,{fontWeight:"bold",children:"No known allergies"})})]}),e.jsxs(t,{h:"10vh",p:"12px",fontSize:"12px",bg:"white",border:"1px solid #EEEFF1",borderRadius:"xl",children:[e.jsx(t,{color:"gray.500",children:"Environmental"}),e.jsx(D,{w:"100%",spacing:1,mt:"2px",overflowY:"scroll",children:r.allergies?r.allergies.Environmental?r.allergies.Environmental.map((s,l)=>e.jsxs(h,{w:"100%",justify:"space-between",align:"center",children:[e.jsx(t,{color:_[s.severity],fontWeight:"bold",children:s.severity}),e.jsx(t,{children:s.name})]},`environment-${l}`)):e.jsx(t,{fontWeight:"bold",children:"No known allergies"}):e.jsx(t,{fontWeight:"bold",children:"No known allergies"})})]})]})]}),e.jsxs(t,{w:"100%",h:"28vh",children:[e.jsx(t,{fontWeight:"bold",ml:"6px",children:"Diagnoses"}),e.jsx($,{mt:"16px",h:"87%",overflowY:"scroll",columns:2,spacing:"4px",children:r.diagnoses.length>0?r.diagnoses.map((s,l)=>e.jsxs(t,{h:"11vh",p:"12px",fontSize:"12px",bg:"white",border:"1px solid #EEEFF1",borderRadius:"xl",children:[e.jsxs(h,{align:"center",justify:"space-between",p:"2px 6px",mb:"4px",fontSize:"11px",children:[e.jsx(t,{bg:n[s.icd_code].color,p:"2px 6px",borderRadius:"md",color:"white",children:s.icd_code}),e.jsx(t,{fontSize:"13px",children:P(s.date)})]}),e.jsx(t,{p:"8px",fontWeight:"bold",children:n[s.icd_code].icd_name})]},l)):e.jsx(t,{pl:"8px",children:"No Available Diagnoses"})})]}),e.jsxs(t,{mt:"24px",w:"100%",children:[e.jsxs(h,{w:"99%",ml:"6px",mb:"8px",align:"center",justify:"space-between",children:[e.jsx(t,{fontWeight:"bold",fontSize:"14px",children:"Visits history"}),e.jsxs(h,{w:"20%",align:"center",borderRadius:"20px",border:"1px solid #ECEDED",children:[e.jsx(t,{w:"50%",h:"100%",p:"2px 4px",borderLeftRadius:"20px",_hover:a==f.TESTS?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:a==f.APPOINTMENTS?"blue.100":"white",color:a==f.APPOINTMENTS?"#1366DE":"gray",fontWeight:a==f.APPOINTMENTS?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>T(f.APPOINTMENTS),children:"Appointments"}),e.jsx(t,{w:"50%",h:"100%",p:"2px 4px",borderRightRadius:"20px",_hover:a==f.APPOINTMENTS?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:a==f.TESTS?"blue.100":"white",color:a==f.TESTS?"#1366DE":"gray",fontWeight:a==f.TESTS?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>T(f.TESTS),children:"Tests"})]})]}),a===f.APPOINTMENTS?w.length>0?e.jsxs(t,{w:"100%",h:"30vh",p:"4px",children:[e.jsxs(h,{align:"center",fontSize:"13px",color:"gray",children:[e.jsx(t,{w:"25%",p:"8px",children:"Date"}),e.jsx(t,{w:"25%",p:"8px",children:"Doctor"}),e.jsx(t,{w:"25%",p:"8px",children:"Specialty"}),e.jsx(t,{w:"15%",textAlign:"center",p:"8px",children:"Note"})]}),e.jsx(t,{w:"100%",h:"90%",overflowY:"scroll",children:e.jsx(D,{spacing:3,children:w.map((s,l)=>e.jsxs(h,{w:"100%",align:"center",fontSize:"12px",color:"black",fontWeight:"bold",children:[e.jsx(t,{w:"25%",p:"8px",borderBottom:"1px solid #D1D1D3",children:s.detail.date}),e.jsx(t,{w:"25%",p:"8px",borderBottom:"1px solid #D1D1D3",children:`Dr. ${s.doctor.name}`}),e.jsx(t,{w:"25%",p:"8px",borderBottom:"1px solid #D1D1D3",children:`${s.doctor.type.charAt(0).toUpperCase()}${s.doctor.type.slice(1)}`}),e.jsx(t,{w:"15%",p:"8px",borderBottom:"1px solid #D1D1D3",textAlign:"center",color:"#1366DE",_hover:{color:"blue",cursor:"pointer"},onClick:()=>y(s.detail.id),children:"Link"})]},`appointment-${l}`))})})]}):e.jsx(t,{children:"No past appointments"}):e.jsx(D,{w:"100%",h:"30vh",spacing:3,p:"4px",overflowY:"scroll",children:e.jsx(J,{data:r})})]})]})}):e.jsxs(D,{w:"100%",h:"82%",overflowY:"scroll",children:[e.jsx(t,{w:"100%",h:"20px",children:e.jsxs(h,{w:"100px",h:"100%",borderRadius:"20px",border:"1px solid #ECEDED",children:[e.jsx(t,{w:"50%",h:"100%",pt:"2px",borderLeftRadius:"20px",_hover:g==j.DOCTOR?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:g==j.DATE?"blue.100":"white",color:g==j.DATE?"#1366DE":"gray",fontWeight:g==j.DATE?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>v(j.DATE),children:"Date"}),e.jsx(t,{w:"50%",h:"100%",pt:"2px",borderRightRadius:"20px",_hover:g==j.DATE?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:g==j.DOCTOR?"blue.100":"white",color:g==j.DOCTOR?"#1366DE":"gray",fontWeight:g==j.DOCTOR?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>v(j.DOCTOR),children:"Doctor"})]})}),R.map(s=>e.jsxs(t,{w:"100%",children:[e.jsx(t,{w:"100%",p:"8px",fontSize:"16px",fontWeight:"bold",borderBottom:"1px solid #ECEDED",children:se(s)?P(s):s}),e.jsx(h,{w:"auto",p:"8px",align:"center",overflowX:"scroll",children:b[s].map(l=>e.jsxs(t,{mr:"8px",w:"13vw",h:"100%",p:"8px",flex:"0 0 auto",borderRadius:"xl",bg:"white",children:[e.jsxs(h,{w:"100%",h:"25%",p:"4px",borderBottom:"1px solid #ECEDED",justify:"space-between",children:[e.jsxs(t,{w:"50%",children:[e.jsx(t,{fontSize:"11px",color:"gray",children:"Prescription code"}),e.jsx(t,{fontSize:"12px",fontWeight:"bold",children:l.id})]}),e.jsxs(t,{w:"50%",textAlign:"right",children:[e.jsx(t,{fontSize:"11px",color:"gray",children:"Date of issue"}),e.jsx(t,{fontSize:"12px",fontWeight:"bold",children:P(l.date)})]})]}),e.jsxs(t,{w:"100%",h:"25%",p:"8px 4px",borderBottom:"1px solid #ECEDED",children:[e.jsx(t,{fontSize:"11px",color:"gray",children:"Issued by"}),e.jsxs(t,{fontSize:"12px",fontWeight:"bold",children:["Dr. ",l.doctor_name]})]}),e.jsxs(t,{w:"100%",h:"50%",px:"4px",py:"16px",children:[e.jsx(t,{fontSize:"11px",color:"gray",children:"Medication and Dosage"}),e.jsxs(t,{w:"100%",h:"95%",p:"8px",borderLeft:"1px solid green",fontSize:"12px",children:[e.jsx(t,{fontWeight:"bold",children:c[l.medication_id].medication_name}),e.jsx(t,{color:"gray",children:c[l.medication_id].type!=="liquid"?`${c[l.medication_id].dose}, ${l.amount} ${c[l.medication_id].type}`:`${c[l.medication_id].dose}`}),e.jsx(t,{fontSize:"10px",overflow:"hidden",children:l.recommendation})]})]})]},l.id))})]},s))]})]})}const L={},G={};function Te({medical_info:o,icd:i,paginator:n,medications:c}){const[r,A]=u.useState(0),p={selected:r,setSelected:A};return u.useMemo(()=>{i.forEach(d=>{L[d.icd_code]=d}),c.forEach(d=>{G[d.id]=d})},[i,c]),e.jsxs(Z,{state:"records",children:[e.jsx(t,{w:"55%",h:"97vh",children:e.jsx(t,{w:"100%",h:"100%",p:"4px 8px",children:r===0?e.jsx(M,{selectManager:p,medicalInfo:o||[],paginator:n}):e.jsx(ne,{selectManager:p,medicalInfo:o||[],icd:L,medications:G})})}),e.jsx(t,{w:"32%",h:"97vh",p:"4px",children:r===0?"":e.jsx(M,{selectManager:p,medicalInfo:o||[],paginator:n})})]})}export{Te as default};
