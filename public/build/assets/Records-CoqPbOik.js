import{q as $,j as e,r as j,W as I}from"./app-L0PSAVpr.js";import{S as b}from"./chunk-ZHMYA64R-IzX89jau.js";import{B as t,F as p}from"./chunk-KRPLQIP4-fYYjkn2x.js";import{d as S}from"./dayjs.min-COpRIwMP.js";import{_ as T}from"./lodash-yc3-dXev.js";import{t as L}from"./TestResultList-BHGMvdAw.js";import{S as y}from"./chunk-NEK3OOAM-pNS6rsU1.js";import{C as M}from"./chunk-Q6Q7I7E5-DDEptH_J.js";import{D as B}from"./DoctorLayout-CMSkMfMd.js";import"./chunk-7JBTTEVG-DZ13MV31.js";import"./chunk-4FCEGNGT-EneP8hbN.js";import"./defineProperty-DmAPQKcv.js";import"./iconBase-CFOGbe_U.js";import"./chunk-5FG5SY5K-C5AlxDTD.js";import"./chunk-JARCRF6W-DjLfiNd0.js";import"./Logo-CaItQl7L.js";const W=S().second(0).millisecond(0),G=(s,d)=>{const i={};let o=Number.MAX_SAFE_INTEGER;if(i.patientId=s.patient.id,i.name=s.patient.name,s.appointments){const n=s.appointments.reduce((m,a)=>{const D=S(a.detail.date).second(0).millisecond(0),E=Math.abs(D.diff(W));return E<o&&a.doctor.id===d.id&&(o=E,m=a),m},{});i.date=n.detail.date;const c=`${n.detail.start_time.split(":")[0]}:${n.detail.start_time.split(":")[1]}`,w=`${n.detail.end_time.split(":")[0]}:${n.detail.end_time.split(":")[1]}`;i.startTime=c,i.endTime=w}return i};function z({selectManager:s,medicalInfo:d}){const{selected:i,setSelected:o}=s,{auth:n}=$().props,c=Object.values(d);return e.jsxs(t,{w:"100%",h:"100%",p:"16px",borderRadius:"xl",bg:"#F6F7FA",children:[e.jsx(t,{fontSize:"20px",fontWeight:"bold",borderBottom:"1px solid black",mb:"24px",children:"Patients List"}),e.jsx(t,{w:"100%",h:"90%",overflowY:"scroll",children:e.jsx(b,{spacing:3,children:c?c.map(w=>{const m=G(w,n.doctor);if(m){const{patientId:a,name:D,date:E,startTime:h,endTime:A}=m;return e.jsxs(t,{w:"100%",p:"16px",borderRadius:"xl",border:"1px solid gray",_hover:{cursor:"pointer",backgroundColor:"#EAF1FA",color:"#1366DE"},bg:i===a?"#EAF1FA":"transparent",color:i===a?"#1366DE":"black",onClick:()=>o(a),fontSize:"14px",children:[e.jsx(t,{fontWeight:"bold",children:D}),S(E).second(0).millisecond(0).diff(W)<0?e.jsx(t,{fontSize:"12px",fontWeight:"bold",mt:"4px",children:"Last visit:"}):e.jsx(t,{fontSize:"12px",fontWeight:"bold",mt:"4px",children:"Next Visit:"}),e.jsxs(t,{fontSize:"12px",children:["Date: ",E]}),e.jsxs(t,{fontSize:"12px",children:["Time: ",`${h} - ${A}`]})]},a)}else return e.jsx(e.Fragment,{})}):e.jsx(t,{fontWeight:"bold",children:"No booked patients"})})})]})}const Y=S().second(0).millisecond(0),v={Stable:"black",Fair:"#AF8CFA",Mild:"#FFC999",Severe:"#DE5031"},g={DATE:"date",DOCTOR:"doctor_name"},u={GENERAL:"general",PRESCRIPTION:"prescription"},x={APPOINTMENTS:"appointments",TESTS:"tests"};function V(s){return!isNaN(Date.parse(s))}const N=s=>{const d=s.split("-");return`${d[2]}.${d[1]}.${d[0]}`},K=s=>s.filter(i=>{const o=i.detail.start_time.split(":"),n=S(i.detail.date).hour(Number(o[0])).minute(Number(o[1])).second(0).millisecond(0);return Y.diff(n)>0}),C=(s,d="date")=>{const i={};return s.forEach(o=>{const n=o.detail;n.doctor_name=o.doctor.name,i[n[d]]?i[n[d]].push(n):i[n[d]]=[n]}),i};function X({selectManager:s,medicalInfo:d,icd:i}){const[o,n]=j.useState({}),[c,w]=j.useState(u.GENERAL),[m,a]=j.useState({}),[D,E]=j.useState([]),[h,A]=j.useState(x.APPOINTMENTS),[f,F]=j.useState(g.DATE),{get:O}=I(),{selected:R}=s,k=Object.keys(m);j.useEffect(()=>{n(d[R])},[R]),j.useEffect(()=>{T.isEmpty(o)||(E(K(o.appointments)),a(C(o.prescriptions,f)))},[o]),j.useMemo(()=>{T.isEmpty(o)||a(C(o.prescriptions,f))},[f]);const _=r=>{O(route("appointment.note",{appointment:r}))};return T.isEmpty(o)?e.jsx(M,{mx:"auto",mt:"45vh",isIndeterminate:!0,color:"blue.300"}):e.jsxs(t,{w:"100%",h:"100%",p:"16px",borderRadius:"xl",bg:"#F6F7FA",children:[e.jsxs(t,{mb:"24px",children:[e.jsx(t,{fontSize:"36px",fontWeight:"bold",children:"Medical Record"}),e.jsxs(p,{align:"center",justify:"flex-start",textAlign:"center",fontSize:"14px",mt:"16px",children:[e.jsx(t,{p:"2px 6px",_hover:c!=u.GENERAL?{color:"#1366DE",cursor:"pointer"}:{},borderBottom:c==u.GENERAL?"1px solid #1366DE":"1px solid gray",color:c==u.GENERAL?"#1366DE":"gray",onClick:()=>{c!=u.GENERAL&&w(u.GENERAL)},children:"General"}),e.jsx(t,{p:"2px 6px",_hover:c!="prescription"?{color:"#1366DE",cursor:"pointer"}:{},borderBottom:c=="prescription"?"1px solid #1366DE":"1px solid gray",color:c=="prescription"?"#1366DE":"gray",onClick:()=>{c!="prescription"&&w("prescription")},children:"Prescriptions"})]})]}),c==u.GENERAL?e.jsx(t,{w:"100%",h:"82%",overflowY:"scroll",children:e.jsxs(b,{spacing:6,children:[e.jsxs(t,{w:"100%",children:[e.jsx(t,{fontWeight:"bold",ml:"6px",children:"Allergies"}),e.jsxs(y,{mt:"16px",columns:3,spacing:"16px",children:[e.jsxs(t,{h:"10vh",p:"12px",fontSize:"12px",bg:"white",border:"1px solid #EEEFF1",borderRadius:"xl",children:[e.jsx(t,{color:"gray.500",children:"Drug"}),e.jsx(b,{w:"100%",spacing:1,mt:"2px",overflowY:"scroll",children:o.allergies?o.allergies.Drug?o.allergies.Drug.map((r,l)=>e.jsxs(p,{w:"100%",justify:"space-between",align:"center",children:[e.jsx(t,{color:v[r.severity],fontWeight:"bold",children:r.severity}),e.jsx(t,{children:r.name})]},`drug-${l}`)):e.jsx(t,{fontWeight:"bold",children:"No known allergies"}):e.jsx(t,{fontWeight:"bold",children:"No known allergies"})})]}),e.jsxs(t,{h:"10vh",p:"12px",fontSize:"12px",bg:"white",border:"1px solid #EEEFF1",borderRadius:"xl",children:[e.jsx(t,{color:"gray.500",children:"Food"}),e.jsx(b,{w:"100%",spacing:1,mt:"2px",overflowY:"scroll",children:o.allergies?o.allergies.Food?o.allergies.Food.map((r,l)=>e.jsxs(p,{w:"100%",justify:"space-between",align:"center",children:[e.jsx(t,{color:v[r.severity],fontWeight:"bold",children:r.severity}),e.jsx(t,{children:r.name})]},`food-${l}`)):e.jsx(t,{fontWeight:"bold",children:"No known allergies"}):e.jsx(t,{fontWeight:"bold",children:"No known allergies"})})]}),e.jsxs(t,{h:"10vh",p:"12px",fontSize:"12px",bg:"white",border:"1px solid #EEEFF1",borderRadius:"xl",children:[e.jsx(t,{color:"gray.500",children:"Environmental"}),e.jsx(b,{w:"100%",spacing:1,mt:"2px",overflowY:"scroll",children:o.allergies?o.allergies.Environmental?o.allergies.Environmental.map((r,l)=>e.jsxs(p,{w:"100%",justify:"space-between",align:"center",children:[e.jsx(t,{color:v[r.severity],fontWeight:"bold",children:r.severity}),e.jsx(t,{children:r.name})]},`environment-${l}`)):e.jsx(t,{fontWeight:"bold",children:"No known allergies"}):e.jsx(t,{fontWeight:"bold",children:"No known allergies"})})]})]})]}),e.jsxs(t,{w:"100%",h:"28vh",children:[e.jsx(t,{fontWeight:"bold",ml:"6px",children:"Diagnoses"}),e.jsx(y,{mt:"16px",h:"87%",overflowY:"scroll",columns:2,spacing:"4px",children:o.diagnoses.length>0?o.diagnoses.map((r,l)=>e.jsxs(t,{h:"11vh",p:"12px",fontSize:"12px",bg:"white",border:"1px solid #EEEFF1",borderRadius:"xl",children:[e.jsxs(p,{align:"center",justify:"space-between",p:"2px 6px",mb:"4px",fontSize:"11px",children:[e.jsx(t,{bg:i[r.icd_code].color,p:"2px 6px",borderRadius:"md",color:"white",children:r.icd_code}),e.jsx(t,{fontSize:"13px",children:N(r.date)})]}),e.jsx(t,{p:"8px",fontWeight:"bold",children:i[r.icd_code].icd_name})]},l)):e.jsx(t,{pl:"8px",children:"No Available Diagnoses"})})]}),e.jsxs(t,{mt:"24px",w:"100%",children:[e.jsxs(p,{w:"99%",ml:"6px",mb:"8px",align:"center",justify:"space-between",children:[e.jsx(t,{fontWeight:"bold",fontSize:"14px",children:"Visits history"}),e.jsxs(p,{w:"20%",align:"center",borderRadius:"20px",border:"1px solid #ECEDED",children:[e.jsx(t,{w:"50%",h:"100%",p:"2px 4px",borderLeftRadius:"20px",_hover:h==x.TESTS?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:h==x.APPOINTMENTS?"blue.100":"white",color:h==x.APPOINTMENTS?"#1366DE":"gray",fontWeight:h==x.APPOINTMENTS?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>A(x.APPOINTMENTS),children:"Appointments"}),e.jsx(t,{w:"50%",h:"100%",p:"2px 4px",borderRightRadius:"20px",_hover:h==x.APPOINTMENTS?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:h==x.TESTS?"blue.100":"white",color:h==x.TESTS?"#1366DE":"gray",fontWeight:h==x.TESTS?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>A(x.TESTS),children:"Tests"})]})]}),h===x.APPOINTMENTS?D.length>0?e.jsxs(t,{w:"100%",h:"30vh",p:"4px",children:[e.jsxs(p,{align:"center",fontSize:"13px",color:"gray",children:[e.jsx(t,{w:"25%",p:"8px",children:"Date"}),e.jsx(t,{w:"25%",p:"8px",children:"Doctor"}),e.jsx(t,{w:"25%",p:"8px",children:"Specialty"}),e.jsx(t,{w:"15%",textAlign:"center",p:"8px",children:"Note"})]}),e.jsx(t,{w:"100%",h:"90%",overflowY:"scroll",children:e.jsx(b,{spacing:3,children:D.map((r,l)=>e.jsxs(p,{w:"100%",align:"center",fontSize:"12px",color:"black",fontWeight:"bold",children:[e.jsx(t,{w:"25%",p:"8px",borderBottom:"1px solid #D1D1D3",children:r.detail.date}),e.jsx(t,{w:"25%",p:"8px",borderBottom:"1px solid #D1D1D3",children:`Dr. ${r.doctor.name}`}),e.jsx(t,{w:"25%",p:"8px",borderBottom:"1px solid #D1D1D3",children:`${r.doctor.type.charAt(0).toUpperCase()}${r.doctor.type.slice(1)}`}),e.jsx(t,{w:"15%",p:"8px",borderBottom:"1px solid #D1D1D3",textAlign:"center",color:"#1366DE",_hover:{color:"blue",cursor:"pointer"},onClick:()=>_(r.detail.id),children:"Link"})]},`appointment-${l}`))})})]}):e.jsx(t,{children:"No past appointments"}):e.jsx(b,{w:"100%",h:"30vh",spacing:3,p:"4px",overflowY:"scroll",children:e.jsx(L,{data:o})})]})]})}):e.jsxs(b,{w:"100%",h:"82%",overflowY:"scroll",children:[e.jsx(t,{w:"100%",h:"20px",children:e.jsxs(p,{w:"100px",h:"100%",borderRadius:"20px",border:"1px solid #ECEDED",children:[e.jsx(t,{w:"50%",h:"100%",pt:"2px",borderLeftRadius:"20px",_hover:f==g.DOCTOR?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:f==g.DATE?"blue.100":"white",color:f==g.DATE?"#1366DE":"gray",fontWeight:f==g.DATE?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>F(g.DATE),children:"Date"}),e.jsx(t,{w:"50%",h:"100%",pt:"2px",borderRightRadius:"20px",_hover:f==g.DATE?{backgroundColor:"#EAF1FA",color:"#1366DE",cursor:"pointer"}:{cursor:"default"},bg:f==g.DOCTOR?"blue.100":"white",color:f==g.DOCTOR?"#1366DE":"gray",fontWeight:f==g.DOCTOR?"bold":"",fontSize:"10px",textAlign:"center",onClick:()=>F(g.DOCTOR),children:"Doctor"})]})}),k.map(r=>e.jsxs(t,{w:"100%",children:[e.jsx(t,{w:"100%",p:"8px",fontSize:"16px",fontWeight:"bold",borderBottom:"1px solid #ECEDED",children:V(r)?N(r):r}),e.jsx(p,{w:"auto",h:"30vh",p:"8px",align:"center",overflowX:"scroll",children:m[r].map(l=>e.jsxs(t,{mr:"8px",w:"13vw",h:"100%",p:"8px",flex:"0 0 auto",borderRadius:"xl",bg:"white",children:[e.jsxs(p,{w:"100%",h:"25%",p:"4px",borderBottom:"1px solid #ECEDED",justify:"space-between",children:[e.jsxs(t,{w:"50%",children:[e.jsx(t,{fontSize:"11px",color:"gray",children:"Prescription code"}),e.jsx(t,{fontSize:"12px",fontWeight:"bold",children:l.id})]}),e.jsxs(t,{w:"50%",textAlign:"right",children:[e.jsx(t,{fontSize:"11px",color:"gray",children:"Date of issue"}),e.jsx(t,{fontSize:"12px",fontWeight:"bold",children:N(l.date)})]})]}),e.jsxs(t,{w:"100%",h:"25%",p:"8px 4px",borderBottom:"1px solid #ECEDED",children:[e.jsx(t,{fontSize:"11px",color:"gray",children:"Issued by"}),e.jsxs(t,{fontSize:"12px",fontWeight:"bold",children:["Dr. ",l.doctor_name]})]}),e.jsxs(t,{w:"100%",h:"50%",px:"4px",py:"16px",children:[e.jsx(t,{fontSize:"11px",color:"gray",children:"Medication and Dosage"}),e.jsxs(t,{w:"100%",h:"95%",p:"8px",borderLeft:"1px solid green",fontSize:"12px",children:[e.jsx(t,{fontWeight:"bold",children:l.medication_name}),e.jsx(t,{color:"gray",children:`${l.dose}, ${l.pill_per_day}`}),e.jsx(t,{fontSize:"10px",overflow:"hidden",children:l.recommendation})]})]})]},l.id))})]},r))]})]})}const P={};function pe({medical_info:s,icd:d}){const[i,o]=j.useState(0),n={selected:i,setSelected:o};return j.useMemo(()=>{d.forEach(c=>{P[c.icd_code]=c})},[d]),e.jsxs(B,{state:"records",children:[e.jsx(t,{w:"55%",h:"100%",children:e.jsx(t,{w:"100%",h:"100%",p:"4px 8px",children:i===0?e.jsx(z,{selectManager:n,medicalInfo:s||[]}):e.jsx(X,{selectManager:n,medicalInfo:s||[],icd:P})})}),e.jsx(t,{w:"32%",h:"100%",p:"4px",children:i===0?"":e.jsx(z,{selectManager:n,medicalInfo:s||[]})})]})}export{pe as default};
